(function(e){function t(t){for(var i,o,s=t[0],a=t[1],l=t[2],d=0,b=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(c,o)&&c[o]&&b.push(c[o][0]),c[o]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);u&&u(t);while(b.length)b.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var a=n[s];0!==c[a]&&(i=!1)}i&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},c={app:0},r=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/rescore/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],a=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=a;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"13c3":function(e,t,n){},"42f9":function(e,t,n){"use strict";n("13c3")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("92c6");var i=n("7a23"),c=(n("4160"),n("b0c0"),n("159b"),{key:0,class:"hero is-fullheight"}),r=Object(i["g"])('<div class="hero-body"><div class="container is-max-desktop has-text-centered"><h1 class="title is-size-2 pb-4">Anilist Rescorer</h1><p class="subtitle is-size-4"> Tired of half the anime on your list being scored way too high by a younger you with a shittier taste? Want to revamp your list but it&#39;s too much of a pain to do it normally? Welcome to the anime rescorer. </p><a class="button is-info is-medium" href="https://anilist.co/api/v2/oauth/authorize?client_id=4281&amp;response_type=token"> Login with AniList </a></div></div>',1),o={key:1,class:"section"},s={class:"container has-text-centered"},a=Object(i["i"])("h2",{class:"title"}," Pick the one you like more",-1),l=Object(i["i"])("h3",{class:"subtitle"},"Your scores will adjust accordingly.",-1),u={class:"columns is-centered"},d={class:"container mt-6"},b=Object(i["i"])("h2",{class:"title has-text-centered"},"Your Anime List",-1),m=Object(i["i"])("p",{class:"subtitle has-text-centered"},"Click on any number in the New Score column to edit it directly.",-1),h={class:"buttons"},p={class:"table is-hoverable is-fullwidth is-size-5 is-size-6-mobile"},f=Object(i["i"])("thead",null,[Object(i["i"])("tr",null,[Object(i["i"])("th",{style:{width:"1%"},class:"is-hidden-mobile"}),Object(i["i"])("th",null,"Name"),Object(i["i"])("th",{class:"has-text-centered"},"Original Score"),Object(i["i"])("th",{class:"has-text-centered"},"New Score")])],-1);function j(e,t,n,j,O,g){var v=this,y=Object(i["n"])("AnimeCompare"),k=Object(i["n"])("AnimeItem"),S=Object(i["n"])("ConfirmModal");return Object(i["j"])(),Object(i["e"])(i["a"],null,[O.accessToken?Object(i["f"])("",!0):(Object(i["j"])(),Object(i["e"])("div",c,[r])),O.accessToken?(Object(i["j"])(),Object(i["e"])("section",o,[Object(i["i"])("div",s,[a,l,Object(i["i"])("div",u,[Object(i["i"])(i["c"],{name:"compare-list"},{default:Object(i["r"])((function(){return[(Object(i["j"])(!0),Object(i["e"])(i["a"],null,Object(i["m"])(O.compareSet,(function(e){return Object(i["j"])(),Object(i["e"])(y,{key:e.id,name:e.name,id:e.id,largeImgUrl:e.largeImgUrl,score:e.score,onComparisonClicked:g.comparisonClick},null,8,["name","id","largeImgUrl","score","onComparisonClicked"])})),128))]})),_:1})]),Object(i["i"])("button",{class:"button is-light is-size-5-desktop",onClick:t[1]||(t[1]=function(){return g.newComparison.apply(g,arguments)})},"Skip")]),Object(i["i"])("div",d,[b,m,Object(i["i"])("div",h,[Object(i["i"])("button",{class:"button is-warning is-size-5-desktop",onClick:t[2]||(t[2]=function(){return g.updateList.apply(g,arguments)})},"Update"),Object(i["i"])("button",{class:"button is-danger is-size-5-desktop",onClick:t[3]||(t[3]=function(e){return v.animeList.forEach((function(e){return e.score=e.ogScore}))})},"Reset"),Object(i["i"])("button",{class:"button is-info is-size-5-desktop",onClick:t[4]||(t[4]=function(e){return v.animeList.forEach((function(e){return e.score=50}))})},"Set all to 50")]),Object(i["i"])("table",p,[f,Object(i["i"])(i["c"],{name:"flip-list",tag:"tbody"},{default:Object(i["r"])((function(){return[(Object(i["j"])(!0),Object(i["e"])(i["a"],null,Object(i["m"])(g.sortedAnimeList,(function(e){return Object(i["j"])(),Object(i["e"])("tr",{key:e.id},[Object(i["i"])(k,{name:e.name,imgUrl:e.imgUrl,score:e.score,"onUpdate:score":function(t){return e.score=t},id:e.id,ogScore:e.ogScore},null,8,["name","imgUrl","score","onUpdate:score","id","ogScore"])])})),128))]})),_:1})])])])):Object(i["f"])("",!0),Object(i["i"])(S,{active:O.confirmModalActive,onClose:t[5]||(t[5]=function(e){return O.confirmModalActive=!1}),onConfirmed:g.updateList,onBypass:t[6]||(t[6]=function(e){return v.confirmModalBypass=!v.confirmModalBypass})},null,8,["active","onConfirmed"])],64)}n("99af"),n("4de4"),n("7db0"),n("d81d"),n("fb6a"),n("d3b7"),n("ac1f"),n("466d"),n("ddb0");var O=n("2909"),g=n("3835"),v=n("b85c"),y=(n("a9e3"),Object(i["u"])("data-v-460c3e97"));Object(i["l"])("data-v-460c3e97");var k={class:"is-hidden-mobile"},S={class:"has-text-centered"},C={key:1};Object(i["k"])();var w=y((function(e,t,n,c,r,o){var s=this,a=Object(i["o"])("focus");return Object(i["j"])(),Object(i["e"])(i["a"],null,[Object(i["i"])("td",k,[Object(i["i"])("figure",{class:"image is-48x48",style:r.backgroundImg},null,4)]),Object(i["i"])("td",null,[Object(i["i"])("span",null,Object(i["p"])(n.name),1)]),Object(i["i"])("td",S,[Object(i["i"])("span",null,Object(i["p"])(n.ogScore),1)]),Object(i["i"])("td",{class:["has-text-centered",o.scoreClass]},[this.edit?Object(i["s"])((Object(i["j"])(),Object(i["e"])("input",{key:0,type:"number",min:"1",max:"100",size:"1",class:"input",value:n.score,onBlur:t[1]||(t[1]=function(t){s.edit=!1,e.$emit("update:score",Number(t.target.value))}),onKeyup:t[2]||(t[2]=Object(i["t"])((function(t){s.edit=!1,e.$emit("update:score",Number(t.target.value))}),["enter"]))},null,40,["value"])),[[a]]):(Object(i["j"])(),Object(i["e"])("div",C,[Object(i["i"])("label",{onClick:t[3]||(t[3]=function(e){s.edit=!0})},Object(i["p"])(o.roundedScore),1)]))],2)],64)})),I=n("53ca"),L={props:{id:{required:!0,type:Number},name:{required:!0,type:String},imgUrl:{required:!0,type:String},score:{type:Number},ogScore:{type:Number}},data:function(){return{backgroundImg:{"background-image":"url("+this.imgUrl+")","background-position":"center","background-size":"cover"},edit:!1}},computed:{roundedScore:function(){return console.log(Object(I["a"])(this.score)),"number"!=typeof this.score&&this.$emit("update:score",this.ogScore),this.score>100?100:this.score<1?1:Math.round(this.score)},scoreClass:function(){return this.roundedScore>this.ogScore?"has-text-success-dark":this.roundedScore<this.ogScore?"has-text-danger-dark":"has-text-grey-light"}},directives:{focus:{mounted:function(e){e.focus()}}}};n("42f9");L.render=w,L.__scopeId="data-v-460c3e97";var T=L,x=Object(i["u"])("data-v-4ec22367");Object(i["l"])("data-v-4ec22367");var A={class:"compare-card"},M={class:"image is-4by5"},_={class:"is-size-3"};Object(i["k"])();var U=x((function(e,t,n,c,r,o){var s=this;return Object(i["j"])(),Object(i["e"])("div",{class:"column is-4",onClick:t[1]||(t[1]=function(e){return s.$emit("comparison-clicked",s.id)})},[Object(i["i"])("div",A,[Object(i["i"])("figure",M,[Object(i["i"])("img",{src:n.largeImgUrl},null,8,["src"])]),Object(i["i"])("p",_,Object(i["p"])(n.name),1)])])})),q={props:{id:{type:Number},name:{required:!0,type:String},largeImgUrl:{required:!0,type:String},score:{required:!0,type:Number}}};n("59dd");q.render=U,q.__scopeId="data-v-4ec22367";var N=q,$=Object(i["u"])("data-v-65d31836");Object(i["l"])("data-v-65d31836");var z={class:"modal is-active"},P=Object(i["i"])("button",{class:"modal-close is-large","aria-label":"close"},null,-1),E={class:"modal-content box has-background-white"},B=Object(i["i"])("p",{class:"title"},"Update your list?",-1),J=Object(i["i"])("p",null,[Object(i["h"])(" This will "),Object(i["i"])("strong",{class:"has-text-danger-dark"},"permanently"),Object(i["h"])(" overwrite the current scores on your list. Other info such as notes or start/end dates will not be affected. Are you sure you want to do this? ")],-1),R={class:"has-text-right my-3"},Y={class:"checkbox"},D=Object(i["h"])(" Don't ask me again ");Object(i["k"])();var V=$((function(e,t,n,c,r,o){var s=this;return Object(i["j"])(),Object(i["e"])(i["b"],{name:"fade"},{default:$((function(){return[Object(i["s"])(Object(i["i"])("div",z,[Object(i["i"])("div",{class:"modal-background",onClick:t[1]||(t[1]=function(e){return s.$emit("close")})},[P]),Object(i["i"])(i["b"],{name:"scale-fade"},{default:$((function(){return[Object(i["s"])(Object(i["i"])("div",E,[B,J,Object(i["i"])("div",R,[Object(i["i"])("label",Y,[Object(i["i"])("input",{type:"checkbox",onChange:t[2]||(t[2]=function(e){return s.$emit("bypass")})},null,32),D])]),Object(i["i"])("button",{class:"button is-success is-pulled-right ml-3",onClick:t[3]||(t[3]=function(e){s.$emit("confirmed"),s.$emit("close")})},"Yes"),Object(i["i"])("button",{class:"button is-light is-pulled-right",onClick:t[4]||(t[4]=function(e){return s.$emit("close")})},"Cancel")],512),[[i["q"],n.active]])]})),_:1})],512),[[i["q"],n.active]])]})),_:1})})),W={props:{active:{required:!0,type:Boolean}}};n("f567");W.render=V,W.__scopeId="data-v-65d31836";var K=W,F={name:"App",components:{AnimeItem:T,AnimeCompare:N,ConfirmModal:K},data:function(){return{animeList:[],compareSet:[],tempCompareSet:[],userError:"",accessToken:null,confirmModalActive:!1,confirmModalBypass:!1}},created:function(){sessionStorage.getItem("accessToken")?(this.accessToken=sessionStorage.getItem("accessToken"),this.getUserId()):this.getAccessToken()},methods:{getAccessToken:function(){try{this.accessToken=window.location.hash.match(/(?<=access_token=)(.*?)(?=&)/)[0],this.getUserId(),sessionStorage.setItem("accessToken",this.accessToken)}catch(e){e instanceof TypeError||console.log(e)}},getUserId:function(){var e=this,t="\n        query {\n          Viewer {\n            id\n          }\n        }\n      ",n="https://graphql.anilist.co",i={method:"POST",headers:{Authorization:"Bearer "+this.accessToken,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:t})};fetch(n,i).then((function(e){return e.json()})).then((function(t){return e.getList(t.data.Viewer.id)})).catch(this.handleAccessTokenError)},handleAccessTokenError:function(){this.accessToken=null,sessionStorage.setItem("accessToken",this.accessToken),this.getAccessToken()},getList:function(e){var t=this;if(sessionStorage.getItem("animeList"))return this.animeList=JSON.parse(sessionStorage.getItem("animeList")),this.newComparison(),1;var n="\n        query ($userId: Int) {\n          MediaListCollection (userId: $userId, type: ANIME) {\n            lists {\n              name\n              status\n              entries {\n                score(format: POINT_100)\n                media {\n                  id\n                  title {\n                    romaji\n                  }\n                  coverImage {\n                    extraLarge\n                    large\n                    medium\n                    color\n                  }\n                }\n              }\n            }\n          }\n        }\n      ",i={userId:e},c="https://graphql.anilist.co",r={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:n,variables:i})};fetch(c,r).then((function(e){return e.json()})).then((function(e){return t.renderList(e)}))},renderList:function(e){this.animeList.length=0;var t,n=Object(v["a"])(e.data.MediaListCollection.lists);try{for(n.s();!(t=n.n()).done;){var i=t.value;if("COMPLETED"==i.status){var c,r=Object(v["a"])(i.entries);try{for(r.s();!(c=r.n()).done;){var o=c.value,s=o.score,a=o.media.id,l=o.media.title.romaji,u=o.media.coverImage.medium,d=o.media.coverImage.extraLarge;0!=s&&this.animeList.push({name:l,id:a,imgUrl:u,largeImgUrl:d,score:s,ogScore:s})}}catch(b){r.e(b)}finally{r.f()}}}}catch(b){n.e(b)}finally{n.f()}this.newComparison()},updateList:function(){if(!this.confirmModalBypass&&!this.confirmModalActive)return this.confirmModalActive=!0,1;var e,t=this.animeList.filter((function(e){return e.score!=e.ogScore})),n=t.map((function(e){return e.score>100?100:e.score<1?1:Math.round(e.score)})),i="",c="",r={},o=Object(v["a"])(t.entries());try{for(o.s();!(e=o.n()).done;){var s=Object(g["a"])(e.value,2),a=s[0],l=s[1];i+="$id".concat(a,": Int, $score").concat(a,": Int,"),c+="\n          s".concat(a,": SaveMediaListEntry (mediaId: $id").concat(a,", scoreRaw: $score").concat(a,") {\n            score\n          }"),r["id".concat(a)]=l.id,r["score".concat(a)]=n[a]}}catch(b){o.e(b)}finally{o.f()}i=i.slice(0,-1),c="mutation (".concat(i,") {\n")+c+"}";var u="https://graphql.anilist.co",d={method:"POST",headers:{Authorization:"Bearer "+this.accessToken,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:c,variables:r})};fetch(u,d).then((function(e){return e.json()})).then((function(e){return console.log(e)}))},comparisonClick:function(e){var t=this.compareSet.find((function(t){return t.id==e})),n=this.compareSet.find((function(t){return t.id!=e})),i=1/(1+Math.pow(10,(n.score-t.score)/20));t.score=t.score+8*(1-i);var c=1/(1+Math.pow(10,(t.score-n.score)/20));n.score=n.score+8*(0-c),this.newComparison()},newComparison:function(){this.compareSet.length=0;var e=function(e){return Math.floor(Math.random()*e)},t=this.animeList[e(this.animeList.length)],n=this.animeList.filter((function(e){return e!=t})),i=n[e(n.length)];this.tempCompareSet=[t,i],window.setTimeout(this.setComparison,600)},setComparison:function(){this.compareSet=this.tempCompareSet}},computed:{sortedAnimeList:function(){return this.animeList.length&&sessionStorage.setItem("animeList",JSON.stringify(this.animeList)),Object(O["a"])(this.animeList).sort((function(e,t){return t.score-e.score}))}}};n("64be");F.render=j;var G=F;Object(i["d"])(G).mount("#app")},"59dd":function(e,t,n){"use strict";n("d45e")},"64be":function(e,t,n){"use strict";n("c894")},a06f:function(e,t,n){},c894:function(e,t,n){},d45e:function(e,t,n){},f567:function(e,t,n){"use strict";n("a06f")}});
//# sourceMappingURL=app.21a12462.js.map